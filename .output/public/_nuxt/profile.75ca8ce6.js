import{a as R,_ as J}from"./close.0c8aa01a.js";import{_ as W}from"./Dropdown.e7cb3bfc.js";import{u as Y,a6 as q,a7 as K,a8 as Q,r as o,a9 as X,J as Z,H as ee,b as le,d as t,t as c,y as te,g as i,i as u,B as V,w as m,T as ae,L as se,D as oe,E as ne,j as ue,S as re,o as N,h as C,x as ie,e as de,aa as ve,R as fe}from"./entry.3613223e.js";import{n as ce,_ as pe}from"./Modal.ba9b7263.js";import{_ as me}from"./info.c3e01190.js";import"./tick.89420351.js";const _e={class:"container my-5 flex justify-center"},ge={class:"bg-white max-w-[600px] w-full rounded-2xl p-4 lg:p-8 flex flex-col"},xe={class:"flex justify-end"},he={class:"text-darkBlue font-bold text-[32px] leading-normal text-center"},be={class:"flex flex-col gap-4"},ye={class:"flex gap-2"},Be=t("img",{src:me,alt:"info"},null,-1),$e={class:"text-xs text-secondary leading-normal"},we={class:"flex flex-col gap-4"},Ve={class:"fixed-center z-[99] bg-white rounded-2xl p-4 flex flex-col max-w-[393px] w-[calc(100%-32px)] md:w-full"},Ce=t("img",{src:J,alt:"close"},null,-1),ke=[Ce],Te={class:"flex flex-col gap-8"},De={class:"text-darkBlue font-bold text-2xl leading-normal text-center"},Oe={class:"flex flex-col gap-4"},Pe={__name:"profile",async setup(Ie){let T,D;const{locale:O}=Y(),j=q(),F=K(),I=Q(),h=o(!1),_=o(!1),L=X(),a=Z();a.value||([T,D]=ee(()=>se(O.value)),await T,D());const d=o(a.value.first_name),v=o(a.value.last_name),f=o(null),n=o(a.value.date_birthday?a.value.date_birthday.split("-").reverse().join("."):null),p=o(ce(`+998${a.value.phone_number}`,!1).replace("(","").replace(")","")),k=o(a.value.date_birthday.split("-").reverse().join(".")),b=o(null);L.value.map((l,e)=>{l.value==a.value.gender&&(f.value=e,b.value=e)});const y=o(!1),B=o(!1),g=o(!1),x=o(!1),$=(l="all")=>{if((l=="first"||l=="all")&&(!d.value||d.value.trim().length<3?y.value=!0:y.value=!1),(l=="last"||l=="all")&&(!v.value||v.value.trim().length<3?B.value=!0:B.value=!1),(l=="gender"||l=="all")&&(f.value==null?g.value=!0:g.value=!1),l=="birth"||l=="all")if(!n.value)x.value=!0;else if(n.value.length==10){n.value.substring(0,2),n.value.substring(3,5);const e=n.value.substring(6,10);x.value=!G(e)}else x.value=!0;return d.value!==a.value.first_name||v.value!==a.value.last_name||f.value!==b.value||n.value!==k.value?h.value=!0:h.value=!1,!y.value&&!B.value&&!g.value&&!x.value},E=l=>{f.value=l,g.value=!1,$("gender")},G=l=>{const e=new Date,r=new Date(l);return!(isNaN(r)||r.getTime()>=e.getTime()||r.getFullYear()<1900)},P=()=>{ve(),_.value=!1,fe(j("/"))},S=()=>{p.value||(p.value="+998 ")},U=()=>{p.value=="+998 "&&(p.value=null)},M=async()=>{let l={};d.value!==a.value.first_name&&(l.first_name=d.value),v.value!==a.value.last_name&&(l.last_name=v.value),f.value!==b.value&&(l.gender=f.value+1),n.value!==k.value&&(l.date_birthday=n.value.split(".").reverse().join("-"));const e=oe("access"),{data:r}=await ne(`${O.value}/auth/update-profile/`,{method:"PATCH",body:l,headers:{Authorization:`Bearer ${e.value}`}});r.value?(I.value="toast.changed",a.value=r.value,h.value=!1,a.value.first_name=d.value,a.value.last_name=v.value,b.value=f.value,k.value=n.value):I.value="toast.error",F.value=!0};return(l,e)=>{const r=R,A=W,w=ue,z=re,H=pe;return N(),le("div",null,[t("div",_e,[t("div",ge,[t("div",xe,[t("div",{onClick:e[0]||(e[0]=s=>_.value=!0),class:"px-4 flex-center h-10 text-red text-sm leading-normal rounded-lg hover:bg-[#E5E9F0] active:bg-[#CCD3E1] cursor-pointer"},c(l.$t("logout")),1)]),t("form",{onSubmit:e[8]||(e[8]=te(()=>{},["prevent"])),class:"flex flex-col gap-8"},[t("p",he,c(l.$t("profile")),1),t("div",be,[i(r,{placeholder:"input.name",modelValue:u(d),"onUpdate:modelValue":e[1]||(e[1]=s=>V(d)?d.value=s:null),inputID:"first-name",type:"text",error:u(y)?"error.first":null,onOnBlur:e[2]||(e[2]=s=>$("first"))},null,8,["modelValue","error"]),i(r,{placeholder:"input.surname",modelValue:u(v),"onUpdate:modelValue":e[3]||(e[3]=s=>V(v)?v.value=s:null),inputID:"last-name",type:"text",error:u(B)?"error.last":null,onOnBlur:e[4]||(e[4]=s=>$("last"))},null,8,["modelValue","error"]),i(A,{options:u(L),placeholder:"userGenderTitle",selected:u(f),onOnChange:E,error:u(g)?"error.gender":null},null,8,["options","selected","error"]),i(r,{placeholder:"input.birth",modelValue:u(n),"onUpdate:modelValue":e[5]||(e[5]=s=>V(n)?n.value=s:null),inputID:"birth-date",type:"text","is-birth":!0,onOnBlur:e[6]||(e[6]=s=>$("birth")),error:u(x)?"error.birth":null},null,8,["modelValue","error"]),i(r,{placeholder:"input.phone",modelValue:u(p),"onUpdate:modelValue":e[7]||(e[7]=s=>V(p)?p.value=s:null),inputID:"phone-number",type:"tel",onOnFocus:S,onOnBlur:U},null,8,["modelValue"]),t("div",ye,[Be,t("p",$e,c(l.$t("profileInfo")),1)])]),t("div",we,[i(w,{state:"primary","is-disabled":!u(h),onClick:M,type:"submit"},{default:m(()=>[C(c(l.$t("save")),1)]),_:1},8,["is-disabled"]),i(z,{to:"/"},{default:m(()=>[i(w,{class:"font-normal w-full",state:"secondary"},{default:m(()=>[C(c(l.$t("backMain")),1)]),_:1})]),_:1})])],32)])]),i(ae,{name:"fade",mode:"out-in"},{default:m(()=>[u(_)?(N(),ie(H,{key:0,onClose:e[11]||(e[11]=s=>_.value=!1)},{body:m(()=>[t("div",Ve,[t("div",{class:"self-end w-6 h-6 flex-center cursor-pointer",onClick:e[9]||(e[9]=s=>_.value=!1)},ke),t("div",Te,[t("p",De,c(l.$t("sureLogout")),1),t("div",Oe,[i(w,{class:"font-normal",state:"secondary",onClick:e[10]||(e[10]=s=>_.value=!1)},{default:m(()=>[C(c(l.$t("cancel")),1)]),_:1}),i(w,{state:"red",onClick:P},{default:m(()=>[C(c(l.$t("logout")),1)]),_:1})])])])]),_:1})):de("",!0)]),_:1})])}}};export{Pe as default};
